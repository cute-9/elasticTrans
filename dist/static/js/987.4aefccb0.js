"use strict";(self["webpackChunkproject_01"]=self["webpackChunkproject_01"]||[]).push([[987],{987:function(e,t,i){i.r(t),i.d(t,{default:function(){return p}});var a=function(){var e=this,t=e._self._c;return t("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"content"},[t("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(t){return e.btnClick("add")}}},[t("i",{staticClass:"el-icon-circle-plus-outline"}),e._v(" 新增")]),t("el-table",{staticClass:"table",attrs:{data:e.tableData,border:""}},[t("el-table-column",{attrs:{type:"index",width:"50",label:"序号",index:e.indexMethod}}),t("el-table-column",{attrs:{prop:"indexName",label:"索引名称"}}),t("el-table-column",{attrs:{prop:"keyNum",label:"数据统计"}}),t("el-table-column",{attrs:{prop:"",label:"操作",width:"300",align:"center"},scopedSlots:e._u([{key:"default",fn:function(i){return[t("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(t){return e.btnClick("view",i.row)}}},[e._v("查看结构")]),t("el-button",{attrs:{type:"warning",size:"mini"},on:{click:function(t){return e.btnClick("clear",i.row)}}},[e._v("清空索引")]),t("el-button",{attrs:{type:"danger",size:"mini"},on:{click:function(t){return e.btnClick("delete",i.row)}}},[e._v("删除")])]}}])})],1),e.dialogVisible?t("el-dialog",{attrs:{title:e.dialogTitle,visible:e.dialogVisible},on:{"update:visible":function(t){e.dialogVisible=t}}},["新增"==e.dialogTitle?t("el-form",{ref:"form",attrs:{model:e.form,"label-width":"80px",rules:e.formRules}},[t("el-form-item",{attrs:{label:"索引名",prop:"indexName"}},[t("el-input",{attrs:{placeholder:"请输入索引名"},model:{value:e.form.indexName,callback:function(t){e.$set(e.form,"indexName",t)},expression:"form.indexName"}})],1),t("el-form-item",{attrs:{align:"center"}},[t("el-button",{attrs:{type:"primary",size:"mini"},on:{click:e.onSubmit}},[e._v("提交")]),t("el-button",{attrs:{size:"mini"},on:{click:e.cancel}},[e._v("取消")])],1)],1):t("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.dialogLoading,expression:"dialogLoading"}],attrs:{data:e.dialogData,border:"",height:"400px"}},[t("el-table-column",{attrs:{prop:"indexName",label:"字段名称"}}),t("el-table-column",{attrs:{prop:"indexType",label:"字段类型"}})],1)],1):e._e()],1)},n=[],r=(i(560),i(4471));function s(e){return(0,r.Z)({url:"index/docStatic",method:"POST",data:e})}function o(e){return(0,r.Z)({url:"index/delete",method:"delete",params:e})}function l(e){return(0,r.Z)({url:"index/truncate",method:"POST",params:e})}function d(e){return(0,r.Z)({url:"index/create",method:"POST",data:e})}var c=i(7683),u={data(){return{loading:!0,tableData:[],indexMethod:1,total:0,currentPage:0,pageSize:20,dialogVisible:!1,dialogData:[],dialogTitle:"",dialogLoading:!1,form:{},formRules:{indexName:[{required:!0,message:"请输入索引名",trigger:"blur"}]}}},created(){this.getInfo()},methods:{handleSizeChange(e){this.pageSize=e},getInfo(){this.dialogLoading=!0,s().then((e=>{this.loading=!1;const{data:t,responseCode:i,responseMsg:a}=e;if(200==i){let e=[];for(let i in t)e.push({indexName:i,keyNum:t[i]}),this.tableData=e}else this.$message.error(a)})).catch((()=>{this.$message.error("网络错误，请稍后重试！"),this.loading=!1}))},btnClick(e,t){switch(e){case"view":this.dialogVisible=!0,this.dialogTitle="查看结构",(0,c.Pw)({indexName:t.indexName}).then((e=>{this.dialogLoading=!1;const{responseCode:t,responseMsg:i,data:a}=e;if(this.dialogData=[],200==t){var n;const e=(t,i)=>{if(t instanceof Object)for(let a in t)a!=i?e(t[a],i):n=t[a];return n};let t=e(a,"properties");for(let i in t)this.dialogData.push({indexName:i,indexType:t[i].type})}}));break;case"clear":this.$confirm("此操作将永久清空该索引, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((()=>{l({indexName:t.indexName}).then((e=>{const{responseCode:t,responseMsg:i}=e;200==t?(this.$message.success(i),this.getInfo()):this.$message.error(i)}))})).catch((()=>{this.$message({type:"info",message:"已取消清空"})}));break;case"delete":this.$confirm("此操作将永久删除该索引, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((()=>{o({indexName:t.indexName}).then((e=>{const{responseCode:t,responseMsg:i}=e;200==t?(this.$message.success(i),this.getInfo()):this.$message.error(i)}))})).catch((()=>{this.$message({type:"info",message:"已取消删除"})}));break;case"add":this.dialogVisible=!0,this.dialogTitle="新增";break}},handleCurrentChange(e){this.currentPage=e},onSubmit(){this.$refs.form.validate((e=>{e&&d({indexName:this.form.indexName}).then((e=>{const{responseCode:t,responseMsg:i}=e;200==t?(this.$message.success(i),this.getInfo(),this.dialogVisible=!1):this.$message.error(i)}))}))},cancel(){this.dialogVisible=!1}}},m=u,g=i(1001),h=(0,g.Z)(m,a,n,!1,null,"58b4b65e",null),p=h.exports},7683:function(e,t,i){i.d(t,{Pw:function(){return n},gh:function(){return s},yC:function(){return r}});var a=i(4471);function n(e){return(0,a.Z)({url:"index/listMapping",method:"POST",params:e})}function r(e){return(0,a.Z)({url:"query/search",method:"POST",data:e})}function s(e){return(0,a.Z)({url:"query/highSearch",method:"POST",data:e})}}}]);